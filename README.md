# Описание к тестовому заданию

## Environment

platform: linux, Python 3.6.9, pytest 6.0.1, pytest-sugar 0.9.4
plugins: sugar-0.9.4, xdist-2.1.0, forked-1.3.0, cov-2.10.1

## Спецификации тестируемого приложения

В связи с тем, что базовые спецификации недостаточно полноценны, мною были внесены следующие дополнения:

**Спецификация форматов и записей базы данных для ключей:**

bear_name:
    
    принимает форматы: str
    диапазон значений: 1 <= name <= 10
    формат хранения в базе данных: str
    конвертация: при сохранении в БД переводит строку в верхний регистр
    
bear_age:
    
    принимает форматы: int, float
    диапазон значений: 0 < age <= 100
    формат хранения в базе данных (конвертация): float
    
bear_id:

    формат хранения в базе данных: int
    создается автоматически сервером при добавлении новой записи
    каждый новый id отличается от предыдущего на 1
    не подлежит изменению

**Спецификации ожидаемых ответов приложения на запросы клиента:**

    200 - Запрос корректен
    400 - В запросе от клинта содержутся недопустимые значения 
    404 - Запрашивается несущесвующая информация (несуществующие записи в БД)

## Структура тестовой директории:

README.md: 

    Спецификации, описание тестовой директории, описание тестов 

common.py:

    КОНСТАНТЫ:
        DOCKER_IMAGE
        HOST
        PORT
        REST_URL
    FIXTURE use_docker(scope='session', autouse=True):
        Sturtup: run container, check connectivity
        Teardown: stop and remove container

rest_api_test.py:

    FIXTURE smoke_test(scope='class'):
        Sturtup: Минимальная функциональная проверка перед началом тестирования
    FIXTURE clear(scope='function'):
        Sturtup: очистка БД перед каждым тестом
    CLASS TestAlaska:
        testsuit, содержащий весь набор тестов

## Описание тест кейсов
_ЗАМЕЧАНИЕ: в связи с тем, что на большинство недопустимых запросов приходит ответ 200 ОК, в большинство 
негативных тестов были добавлены проверки не только на ожидаемый код ответа, но и на то, что кодом 
ответа не является 200 ОК_


Позитивный тест создания и чтения записей в БД
    
    Автотест: test_positive_create_get_bear
    Входные данные: допустимые комбинации значний bear_type, bear_name и bear_age медведей
    Шаги: 
        сформировать конфигурационный json
        послать REST Post на создание записи в БД 
    Ожидаемый результат:
        получен код 200 от приложения
        созданная запись соответствует ожидаемой 
        типы данный в БД соответствуют ожидаемым
    
Позитивный тест проверки id записи при добавлении  
    
    Автотест: test_positive_id_incrementation_create_bear
    Входные данные: None
    Шаги: 
        добавить одну запись
        добавить вторую запись
    Ожидаемый результат
        убедиться, что id второго медведя отличается от id певого на 1

Негавтивный тест создания записи с недопустимым bear_type
    
    Автотест: test_negative_create_bear_types
    Входные данные: список недопустимых значений bear_type
    Шаги: 
        послать REST Post на создание записи
    Ожидаемый результат:
        код ответа не 200
        код ответа 400

Негавтивный тест создания записи с недопустимым bear_name
    
    Автотест: test_negative_create_bear_names
    Входные данные: список недопустимых значений bear_name
    Шаги: 
        послать REST Post на создание записи
    Ожидаемый результат:
        код ответа не 200
        код ответа 400

Негавтивный тест создания записи с недопустимым bear_age
    
    Автотест: test_negative_create_bear_ages
    Входные данные: список недопустимых значений bear_age
    Шаги: 
        послать REST Post на создание записи
    Ожидаемый результат:
        код ответа не 200
        код ответа 400

Негавтивный тест создания записи в БД с id, заданным клиентом
    
    Автотест: test_negative_create_bear_user_ids
    Входные данные: None
    Шаги: 
        послать REST Post на создание записи
    Ожидаемый результат:
        код ответа не 200
        код ответа 400
        запись не создана

Негавтивный тест запроса указанной записи из БД
    
    Автотест: test_negative_get_bear
    Входные данные: список несуществующих и недопустимых id
    Шаги: 
        послать REST Get id из списка
    Ожидаемый результат
        код ответа 404, если id - int 
        код ответа 400, если id - не int

Позитивный тест удаления записей из БД по одной
    
    Автотест: test_positive_delete_one_bear
    Входные данные: None
    Шаги: 
        создать запись
        удалить запись
        запросить удаленную запись
    Ожидаемый результат
        код ответа 200 на удаление записи
        запись не существует при попытке запроса

Негавтивный тест удаления одной несуществующей записи
    
    Автотест: test_negative_delete_one_bear
    Входные данные: None
    Шаги: 
        послать REST Delete несуществующей записи
    Ожидаемый результат
        код ответа 404

Позитивный тест чтения всех записей БД и удаления всех записей БД
    
    Автотест: test_positive_get_all_delete_all_bears
    Входные данные: None
    Шаги: 
        создать 10 записей
        прочитать все записи одним запросом
        удалить все записи одним запросом
    Ожидаемый результат
        количество прочитанных записей == 10
        база данных пуста

Позитивный изменения существующих записей БД
    
    Автотест: test_positive_update_specific_bear_all
    Входные данные: допустимые комбинации значний bear_type, bear_name и bear_age медведей
    Шаги: 
        создать запись
        послать запрос на изменение записи
    Ожидаемый результат:
        код ответа 200
        запись изменена

Негавтивный тест изменения записи с недопустимым значением bear_type
    
    Автотест: test_negative_update_specific_bear_type
    Входные данные: список недопустимых значений bear_type
    Шаги: 
        послать REST Update запрос на изменение записи 
    Ожидаемый результат:
        запись не изменена
        код ответа не 200
        код ответа 400
        
Негавтивный тест изменения записи с недопустимым значением bear_name
    
    Автотест: test_negative_update_specific_bear_name
    Входные данные: список недопустимых значений bear_name
    Шаги: 
        послать REST Update запрос на изменение записи 
    Ожидаемый результат:
        запись не изменена
        код ответа не 200
        код ответа 400
    
    
Негавтивный тест изменения записи с недопустимым значением bear_age
    
    Автотест: test_negative_update_specific_bear_age
    Входные данные: список недопустимых значений bear_age
    Шаги: 
        послать REST Update запрос на изменение записи 
    Ожидаемый результат:
        запись не изменена
        код ответа не 200
        код ответа 400
    
Негавтивный тест изменения bear_id в записи
    
    Автотест: test_negative_update_specific_bear_id
    Входые данные: None
    Шаги: 
        послать REST Update запрос на изменение записи 
    Ожидаемый результат:
        запись не изменена
        код ответа не 200
        код ответа 400
    
Негавтивный тест создания и чтения записей в БД
    
    Автотест: test_negative_use_incorrect_header
    Входые данные: список недопустимых/некорректных заголовков для REST звапросов
    Шаги: 
        послать REST Post на создание записи
    Ожидаемый результат:
        запись не создана
        код ответа не 200
        код ответа 400